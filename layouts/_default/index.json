{{/* layouts/_default/index.json */}}
{{- $index := slice -}}
{{- range where .Site.RegularPages.ByDate.Reverse "Type" "not in"  (slice "page" "json") -}}
	{{ if .Params.dateCreated }}
			{{ $.Scratch.Set "date" (.Params.dateCreated) }}
	{{ else }}
			{{- if isset site.Params "date_format" -}}
				{{- $.Scratch.Set "date" (.Date.Format site.Params.date_format) -}}
			{{- else -}}
				{{- $.Scratch.Set "date" (.Date.Format "2006-01-02") -}}
			{{- end -}}
	{{ end }}
	{{ if not (in .Title "404") }}
    	{{- $index = $index | append (dict "title" ( .Title | plainify ) "permalink" .Permalink "section" (.Section | title) "tags" (apply .Params.tags "plainify" "." ) "categories" (apply .Params.categories "plainify" "." ) "summary" (.Summary | markdownify | htmlUnescape | plainify) "date" ($.Scratch.Get "date") ) -}}
	{{ end }}
{{- end -}}
{{- $index | jsonify -}}